<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
#main{
    width: calc(100% - 10px);
    background-color: antiquewhite;
    height: auto;
    position: fixed;
    bottom: 5px;
    display: none;
}
#inputMsg{
    width: calc(100% - 65px)
}
#chatLog{
    margin-bottom: 65px;
    display: none;
}
    </style>
    <title>Gavin的聊天室</title>
</head>
<body>
    <div id="nickPage">
        <p>输入你想使用的用户名</p>
        <input type="text" id="nickText" maxlength="20" placeholder="Nickname" required>
        <button id="nickButton">GO!</button>
    </div>
    <div id="chatLog">

    </div>
    <div id="main">
        <hr>
        <input type="text" maxlength="200" id="inputMsg" placeholder="内容" required>
        <button id="msgButton">发送</button>
    </div>
    <script src="/socket.io/socket.io.js"></script>
    <script>
const socket = io.connect('ws://localhost:5000/')
const nickName = document.getElementById('nickText')
const nickButton = document.getElementById('nickButton')
const nickPage = document.getElementById('nickPage')
const main = document.getElementById('main')
const chatLog = document.getElementById('chatLog')

nickButton.onclick = function () {
    socket.emit('nick',nickName.value)
    console.log('用户名已发送');
    nickPage.style.display = 'none'
    main.style.display = 'block'
    chatLog.style.display = 'block'
}

const inputMsg = document.getElementById('inputMsg')
const msgButton = document.getElementById('msgButton')

msgButton.onclick = function () {
   socket.emit('msg',inputMsg.value)
   console.log('消息已发送');
}

socket.on('serverMsg',function (...data) {
    chatLog.innerText += data
})

    </script>
</body>
</html>
